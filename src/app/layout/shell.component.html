<div class="min-h-screen bg-muted/40 text-sm text-foreground antialiased">
  <div class="flex min-h-screen">
    <aside
      class="hidden w-20 flex-col border-r bg-background/95 backdrop-blur lg:flex"
    >
      <div class="flex items-center justify-center gap-3 px-6 py-6">
        <button mat-icon-button color="primary" class="size-11 rounded-xl bg-primary/10 text-primary">
          <mat-icon>insights</mat-icon>
        </button>
      </div>

      <mat-nav-list class="flex-1 px-2">
        <ng-container *ngFor="let item of navItems; trackBy: trackByRoute">
          <a
            mat-list-item
            [routerLink]="item.route"
            routerLinkActive="is-active"
            [routerLinkActiveOptions]="{ exact: true }"
            (click)="closeMobileNav()"
            [matTooltip]="item.label"
            matTooltipPosition="right"
            class="mb-1 rounded-xl px-3 py-2 transition-colors duration-150"
            [ngClass]="{
              'bg-primary/10 text-primary shadow-sm': activeNav().route === item.route,
              'text-muted-foreground hover:bg-muted hover:text-foreground': activeNav().route !== item.route
            }"
            [@navReveal]
          >
            <mat-icon matListIcon>{{ navIcon(item.icon) }}</mat-icon>
            <span class="sr-only">{{ item.label }}</span>
          </a>
        </ng-container>
      </mat-nav-list>

      <mat-divider></mat-divider>

    </aside>

    <div class="flex flex-1 flex-col">
      <mat-toolbar class="sticky top-0 z-30 border-b bg-background/90 backdrop-blur" color="transparent">
        <div class="flex items-center gap-2">
          <div>
            <p class="text-xs font-medium uppercase tracking-wider text-muted-foreground">Executive workspace</p>
            <h2 class="text-xl font-semibold tracking-tight sm:text-2xl">{{ activeNav().label }}</h2>
          </div>
        </div>
        <span class="flex-1"></span>
        <button
          mat-icon-button
          matTooltip="Notifications"
          matBadge=" "
          matBadgeColor="primary"
          matBadgeSize="small"
          matBadgeOverlap="false"
        >
          <mat-icon>notifications</mat-icon>
        </button>
        <button mat-icon-button matTooltip="Help center">
          <mat-icon>help_outline</mat-icon>
        </button>
        <ng-container *ngIf="profile() as currentProfile">
          <button mat-button [matMenuTriggerFor]="profileMenu" class="hidden items-center gap-2 rounded-full border border-input bg-background px-2 py-1 text-left text-sm font-medium text-foreground lg:flex">
            <span class="truncate max-w-[8rem]">{{ currentProfile.fullName }}</span>
            <mat-icon>expand_more</mat-icon>
          </button>
          <button mat-icon-button class="lg:hidden" [matMenuTriggerFor]="profileMenu" aria-label="Account menu">
            <mat-icon>account_circle</mat-icon>
          </button>
        </ng-container>
      </mat-toolbar>

      <div class="border-b px-4 py-3 text-sm text-muted-foreground md:px-6 lg:px-8">
        {{ tagline() }}
      </div>

      <main class="flex-1 overflow-y-auto px-4 py-6 md:px-6 lg:px-8">
        <router-outlet></router-outlet>
      </main>
    </div>
  </div>

  <mat-menu #profileMenu="matMenu">
    <button mat-menu-item disabled>
      <mat-icon>person</mat-icon>
      <span>{{ profile()?.fullName }}</span>
    </button>
    <mat-divider></mat-divider>
    <button mat-menu-item (click)="logout()" [disabled]="loggingOut()">
      <mat-icon>logout</mat-icon>
      <span>{{ loggingOut() ? 'Signing outâ€¦' : 'Sign out' }}</span>
    </button>
  </mat-menu>

  <ng-container *ngIf="mobileNavOpen()">
    <div class="lg:hidden">
      <div class="fixed inset-0 z-40 bg-black/40 backdrop-blur-sm" (click)="closeMobileNav()"></div>
      <mat-card class="fixed inset-y-0 left-0 z-50 flex w-72 flex-col rounded-none border-r bg-background">
        <div class="flex items-center justify-between px-5 py-5">
          <div>
            <p class="text-xs font-semibold uppercase tracking-wide text-muted-foreground">Executive Evaluation</p>
            <p class="text-base font-semibold text-foreground">Elevate Pulse</p>
          </div>
          <button mat-icon-button (click)="closeMobileNav()">
            <mat-icon>close</mat-icon>
          </button>
        </div>
        <mat-divider></mat-divider>
        <mat-nav-list class="flex-1 px-2 pb-6">
          <ng-container *ngFor="let item of navItems; trackBy: trackByRoute">
            <a
              mat-list-item
              [routerLink]="item.route"
              (click)="closeMobileNav()"
              class="rounded-xl px-3 py-2 text-sm font-medium transition hover:bg-muted"
              [ngClass]="{
                'bg-muted text-primary': activeNav().route === item.route
              }"
            >
              <mat-icon matListIcon>{{ navIcon(item.icon) }}</mat-icon>
              <div matListItemTitle>{{ item.label }}</div>
              <div matListItemLine class="text-xs text-muted-foreground">{{ item.description }}</div>
            </a>
          </ng-container>
        </mat-nav-list>
      </mat-card>
    </div>
  </ng-container>
</div>